function [pts_out, T]=normalise2D(pts_in) %input is a 3*N matrix of points
N=size(pts_in,2);
pts_in(1,:)=pts_in(1,:)./pts_in(3,:);
pts_in(2,:)=pts_in(2,:)./pts_in(3,:);
pts_in(3,:)=ones(1,N);
mean_v=zeros(2,1);
mean_v(1,1)=mean(pts_in(1,:));
mean_v(2,1)=mean(pts_in(2,:));
pts_in(1,:)=pts_in(1,:)-mean_v(1,1);
pts_in(2,:)=pts_in(2,:)-mean_v(2,1);
x=pts_in(1,:);
y=pts_in(2,:);
fact=sqrt(x.*x+y.*y);
mean_f=mean(fact);
mean_f=sqrt(2)/mean_f ;
T=[